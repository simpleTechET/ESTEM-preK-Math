import{j as e}from"./ui-vendor-C-ksHByf.js";import{r as t}from"./react-vendor-X0Zsz5kA.js";import{C as v,B}from"./card-CONlN9Z4.js";import{s as D,u as Y}from"./index-CuO2FDWj.js";import{S as k}from"./sparkles-DlUJNT9I.js";import{C as J}from"./circle-check-BqsSZ9rF.js";const L=({studentName:n,studentPhoto:o,context:a,type:h,show:l,onClose:i})=>{const[d,r]=t.useState(""),[x,c]=t.useState(!1);t.useEffect(()=>{l&&a&&p()},[l,a,h]);const p=async()=>{c(!0);try{const m=await(await fetch("https://ethio-stem-pre-k-math.vercel.app/api/companion",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentName:n,context:a,type:h})})).json();r(m.message)}catch(f){console.error("AI Companion error:",f),r(`Keep going, ${n}!`)}finally{c(!1)}};return l?e.jsx("div",{className:"fixed bottom-6 right-6 z-50 animate-in slide-in-from-bottom-4",children:e.jsx(v,{className:"max-w-sm border-2 border-primary bg-gradient-to-br from-primary/5 to-secondary/5 shadow-xl",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:o?e.jsx("img",{src:o,alt:n,className:"w-12 h-12 rounded-full object-cover border-2 border-primary"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(k,{className:"w-6 h-6 text-primary"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold text-sm text-primary",children:"Your Study Buddy"}),e.jsx(k,{className:"w-4 h-4 text-primary"})]}),x?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}):e.jsx("p",{className:"text-sm text-foreground",children:d})]}),i&&e.jsx("button",{onClick:i,className:"text-muted-foreground hover:text-foreground",children:"Ã—"})]})})})}):null},H=({items:n,onComplete:o})=>{const a=t.useMemo(()=>D(n),[n]),{isPremium:h,studentPhoto:l}=Y(),[i,d]=t.useState([]),[r,x]=t.useState([]),[c,p]=t.useState(0),[f,m]=t.useState(!1),[I,u]=t.useState(!1),[P,w]=t.useState(""),[z,S]=t.useState("encouragement"),[A]=t.useState(localStorage.getItem("ethiostem-student-name")||"Student"),$=s=>{if(r.includes(s.id)||i.includes(s.id)||f)return;const j=[...i,s.id];if(d(j),j.length===2){m(!0),p(c+1);const[M,T]=j,b=a.find(N=>N.id===M),y=a.find(N=>N.id===T);(b==null?void 0:b.matchId)===(y==null?void 0:y.matchId)?(x([...r,M,T]),w("The student just matched two objects correctly!"),S("celebration"),u(!0),setTimeout(()=>u(!1),5e3),setTimeout(()=>{d([]),m(!1),r.length+2===a.length&&(o==null||o())},800)):(w("The student tried to match objects but they were different. Encourage them to look more carefully at the colors, shapes, and sizes."),S("correction"),u(!0),setTimeout(()=>u(!1),5e3),setTimeout(()=>{d([]),m(!1)},1200))}},C=s=>i.includes(s),g=s=>r.includes(s),E=r.length===a.length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Attempts: ",e.jsx("span",{className:"font-semibold text-foreground",children:c})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Matched: ",e.jsx("span",{className:"font-semibold text-foreground",children:r.length/2})," / ",a.length/2]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:a.map(s=>e.jsxs(v,{onClick:()=>$(s),className:`
              relative aspect-square cursor-pointer transition-all duration-300
              ${g(s.id)?"opacity-50 border-success border-4":""}
              ${C(s.id)?"border-primary border-4 scale-105":""}
              ${!g(s.id)&&!C(s.id)?"hover:scale-105 hover:shadow-playful":""}
            `,children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:e.jsx("img",{src:s.image,alt:"Match item",className:`object-contain transition-all ${s.size==="large"?"w-36 h-36":s.size==="small"?"w-20 h-20":"w-full h-full"}`})}),g(s.id)&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(J,{className:"w-8 h-8 text-success fill-success/20"})})]},s.id))}),E&&e.jsxs(v,{className:"p-8 text-center bg-gradient-to-br from-success/10 to-primary/10 border-2 border-success",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸŽ‰"}),e.jsx("h3",{className:"text-2xl font-bold mb-2 text-foreground",children:"Amazing Job!"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["You matched all the objects! You completed it in ",c," attempts."]}),e.jsx(B,{size:"lg",onClick:o,className:"shadow-playful",children:"Continue Learning"})]}),h&&e.jsx(L,{studentName:A,studentPhoto:l||void 0,context:P,type:z,show:I,onClose:()=>u(!1)})]})};export{H as M};
